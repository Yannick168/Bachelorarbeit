<!-- Bootstrap (only include once per page) -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" /><!-- KaTeX (only include once per page) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" />
<script defer="defer" src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js"></script> 
<script defer="defer" src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js" onload=
"renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:true},{left:'\\(',right:'\\)',display:false}]});"></script>
<div class="container my-4">
    <div class="row">
        <div class="col-12">
            <h3 class="mb-3">
                Hypotrochoid
            </h3>
        </div>
        <!-- Formulas -->

        <div class="col-12 col-lg-10">
            <p class="mb-2 fw-semibold">
                Hypotrochoid (point at distance \( d \) on a circle of radius \( r \) rolling inside a fixed circle of radius \( R \))
            </p>
            $$ \begin{aligned} x(\theta) &amp;= (R-r)\cos(\theta) \;+\; d\cos\!\left(\frac{R-r}{r}\,\theta\right),\\[4pt] y(\theta) &amp;= (R-r)\sin(\theta) \;-\;
            d\sin\!\left(\frac{R-r}{r}\,\theta\right). \end{aligned} $$
            <p class="mb-2 fw-semibold">
                Special case (hypocycloid, \( d = r \))
            </p>
            $$ \begin{aligned} x(\theta) &amp;= (R-r)\cos(\theta) \;+\; r\cos\!\left(\frac{R-r}{r}\,\theta\right),\\[4pt] y(\theta) &amp;= (R-r)\sin(\theta) \;-\;
            r\sin\!\left(\frac{R-r}{r}\,\theta\right). \end{aligned} $$
        </div>
    </div>

    <div class="row mt-4">
        <!-- Controls (left) -->

        <div class="col-12 col-md-4 mb-4">
            <div class="p-3 bg-white rounded shadow-sm">
                <!-- R -->

                <div class="mb-3">
                    <label for="hypoRRange" class="form-label">Outer radius \( R \)</label>
                    <div class="row gx-2 align-items-center">
                        <div class="col">
                            <input type="range" id="hypoRRange" class="form-range" min="0.10" max="8.00" step="0.01" value="4.00" />
                        </div>

                        <div class="col-auto" style="width:6rem;">
                            <input type="number" id="hypoRNum" class="form-control" min="0.10" max="8.00" step="0.01" value="4.00" />
                        </div>
                    </div>
                </div>
                <!-- r -->

                <div class="mb-3">
                    <label for="hyporrRange" class="form-label">Inner radius \( r \)</label>
                    <div class="row gx-2 align-items-center">
                        <div class="col">
                            <input type="range" id="hyporrRange" class="form-range" min="0.10" max="4.00" step="0.01" value="1.00" />
                        </div>

                        <div class="col-auto" style="width:6rem;">
                            <input type="number" id="hyporrNum" class="form-control" min="0.10" max="4.00" step="0.01" value="1.00" />
                        </div>
                    </div>
                </div>
                <!-- d (0 â€¦ 2r, updates with r) -->

                <div class="mb-3">
                    <label for="hypoDRange" class="form-label">Offset \( d \)</label>
                    <div class="row gx-2 align-items-center">
                        <div class="col">
                            <input type="range" id="hypoDRange" class="form-range" min="0.00" max="2.00" step="0.01" value="1.00" />
                        </div>

                        <div class="col-auto" style="width:6rem;">
                            <input type="number" id="hypoDNum" class="form-control" min="0.00" max="2.00" step="0.01" value="1.00" />
                        </div>
                    </div>
                </div>
                <!-- theta -->

                <div class="mb-0">
                    <label for="hypoThetaRange" class="form-label">Position \( \theta \in [0,\,6\pi] \)</label>
                    <div class="row gx-2 align-items-center">
                        <div class="col">
                            <input type="range" id="hypoThetaRange" class="form-range" min="0" max="18.85" step="0.01" value="0" />
                        </div>

                        <div class="col-auto" style="width:6rem;">
                            <input type="number" id="hypoThetaNum" class="form-control" min="0" max="18.85" step="0.01" value="0" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- iFrame (right) -->

        <div class="col-12 col-md-8 d-flex flex-column align-items-center">
            <div class="ratio ratio-16x9" style="max-width: 900px; width: 100%;">
                <iframe id="hypotrochoidFrame" class="w-100 h-100 border-0" allowfullscreen="allowfullscreen" name="hypotrochoidFrame"></iframe>
            </div>
            <ul class="mb-0">
                <li>
                    <strong>Mouse wheel</strong>: zoom
                </li>
            </ul>
        </div>
    </div>
</div>
<script>
/* <![CDATA[ */
window.addEventListener('DOMContentLoaded', () => {
  const frame = document.getElementById('hypotrochoidFrame');
  frame.src = "https://yannick168.github.io/Bachelorarbeit/src/hypotrochoid/hypotrochoid.html?v=" + Date.now();

  const els = {
    RRange:  document.getElementById('hypoRRange'),
    RNum:    document.getElementById('hypoRNum'),
    rRange:  document.getElementById('hyporrRange'),
    rNum:    document.getElementById('hyporrNum'),
    dRange:  document.getElementById('hypoDRange'),
    dNum:    document.getElementById('hypoDNum'),
    theta:   document.getElementById('hypoThetaRange'),
    thetaNum:document.getElementById('hypoThetaNum'),
  };

  const clamp = (v, min, max) => Math.min(max, Math.max(min, v));

  // keep slider <-> number in sync
  function bindPair(rangeEl, numEl, decimals=2) {
    rangeEl.addEventListener('input', () => {
      numEl.value = Number(rangeEl.value).toFixed(decimals);
      if (rangeEl === els.rRange) updateDRange(); // when r changes, adapt d-range
      postUpdate();
    });
    numEl.addEventListener('input', () => {
      rangeEl.value = numEl.value;
      if (numEl === els.rNum) updateDRange();
      postUpdate();
    });
  }

  // d range depends on r: d in [0, 2r]
  function updateDRange() {
    const rVal = parseFloat(els.rNum.value);
    const maxD = Number.isFinite(rVal) ? 2 * rVal : 2.0;
    els.dRange.max = String(maxD);
    els.dNum.max   = String(maxD);

    const dVal = clamp(parseFloat(els.dNum.value), parseFloat(els.dNum.min), maxD);
    els.dNum.value   = Number.isFinite(dVal) ? dVal.toFixed(2) : '1.00';
    els.dRange.value = els.dNum.value;
  }

  function postUpdate() {
    const t = parseFloat(els.thetaNum.value); // t == theta
    const R = parseFloat(els.RNum.value);
    const r = parseFloat(els.rNum.value);
    const d = parseFloat(els.dNum.value);
    if ([t,R,r,d].every(Number.isFinite)) {
      frame.contentWindow?.postMessage({ type: 'updateHypotrochoid', t, R, r, d }, '*');
    }
  }

  // bind pairs
  bindPair(els.RRange, els.RNum, 2);
  bindPair(els.rRange, els.rNum, 2);
  bindPair(els.dRange, els.dNum, 2);
  bindPair(els.theta,  els.thetaNum, 2);

  // init
  updateDRange();
  setTimeout(postUpdate, 300);
});
/*]]>*/
</script>