import"./modulepreload-polyfill-B5Qt9EMX.js";import{S as de,P as fe,W as he,p as pe,q as ge,H as ue,A as oe,h as me,i as we,c as te,F as Me,B as be,d as se,L as Fe,f as ve,g as Ie,G as Ee,r as Se,V as q}from"./three.module-DkuOTbe3.js";import{O as xe}from"./OrbitControls-0F_4tOhn.js";const ke="/Bachelorarbeit/assets/catenoid_finished-Di9ZX2Iv.fe",C=new de,M=new fe(45,window.innerWidth/window.innerHeight,.1,1e3);M.position.set(2,2,3);const B=new he({antialias:!0});B.setSize(window.innerWidth,window.innerHeight);B.setClearColor(16777215);B.toneMapping=pe;B.toneMappingExposure=1.6;document.body.appendChild(B.domElement);const Z=new xe(M,B.domElement);Z.enableDamping=!0;const Ae=new ge(16777215,8,0,2);M.add(Ae);C.add(M);const ce=new ue(16777215,7829367,1);C.add(ce);C.add(new oe(16777215,.2));window.addEventListener("resize",()=>{M.aspect=window.innerWidth/window.innerHeight,M.updateProjectionMatrix(),B.setSize(window.innerWidth,window.innerHeight)});const K=/^(vertices|edges|faces|facets|bodies)\b/i,v=d=>/^[+-]?\d+$/.test(d),U=d=>/^-?\d+$/.test(d),A=d=>/^[+-]?(?:\d*\.\d+|\d+\.?\d*)(?:[eE][+-]?\d+)?$/.test(d),T=d=>d.replace(/\/\*.*?\*\//g,"").trim(),ne=/\(\s*([+-]?(?:\d*\.\d+|\d+\.?\d*)(?:[eE][+-]?\d+)?)\s+([+-]?(?:\d*\.\d+|\d+\.?\d*)(?:[eE][+-]?\d+)?)\s+([+-]?(?:\d*\.\d+|\d+\.?\d*)(?:[eE][+-]?\d+)?)\s*\)/,Ce=/boundary\s+(\d+)/i;function ye(d){const f=d.split(/\r?\n/),l=f.map(t=>t.trim());let u=1,S=.55;for(const t of l){const c=t.match(/^\s*PARAMETER\s+RMAX\s*=\s*([^\s]+)/i);c&&A(c[1])&&(u=parseFloat(c[1]));const n=t.match(/^\s*PARAMETER\s+ZMAX\s*=\s*([^\s]+)/i);n&&A(n[1])&&(S=parseFloat(n[1]))}const a={vertices:[],edges:[],faces:[],facets:[]};for(let t=0;t<l.length;t++)if(K.test(l[t])){const c=l[t].toLowerCase().split(/\s+/)[0];c in a&&a[c].push(t)}const y=t=>{let c=l.length;for(let n=t+1;n<l.length;n++)if(K.test(l[n])){c=n;break}return f.slice(t+1,c)},x=[],p={},k=(t,c,n,r)=>{if(p[t]!==void 0)return;const o=x.length;p[t]=o,x.push([c,n,r])};if(a.vertices.length){const t=y(a.vertices[0]);for(const c of t){if(!c.trim())continue;const n=T(c);if(n){const s=n.split(/\s+/);if(s.length>=4&&v(s[0])&&A(s[1])&&A(s[2])&&A(s[3])){k(parseInt(s[0],10),parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3]));continue}}const r=c.match(/^\s*(\d+)\b/),o=c.match(ne);if(r&&o){const s=parseInt(r[1],10),h=parseFloat(o[1]),I=parseFloat(o[2]),P=parseFloat(o[3]);k(s,h,I,P);continue}const m=T(c);if(m){const s=m.split(/\s+/);if(s.length>=2&&v(s[0])&&A(s[1])){const h=parseInt(s[0],10),I=parseFloat(s[1]),P=c.match(Ce);if(P){const j=parseInt(P[1],10),z=u*Math.cos(I),E=u*Math.sin(I),L=j===1?S:j===2?-S:0;k(h,z,E,L);continue}}}}}else for(const t of f){if(!t.trim())continue;const n=T(t).split(/\s+/);if(n.length>=4&&v(n[0])&&A(n[1])&&A(n[2])&&A(n[3])){k(parseInt(n[0],10),parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3]));continue}const r=t.match(/^\s*(\d+)\b/),o=t.match(ne);if(r&&o){const m=parseInt(r[1],10);k(m,parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3]))}}const W={},H=t=>{for(const c of t){const n=T(c);if(!n)continue;const r=n.split(/\s+/);if(r.length>=3&&v(r[0])&&v(r[1])&&v(r[2])){const o=parseInt(r[0],10),m=parseInt(r[1],10),s=parseInt(r[2],10),h=p[m],I=p[s];if(h===void 0||I===void 0)continue;W[o]=[h,I]}}};if(a.edges.length)for(const t of a.edges)H(y(t));else{const t=a.faces[0]??a.facets[0]??l.length;let c=0;for(let o=t-1;o>=0;o--)if(K.test(l[o])){c=o;break}const n=f.slice(c,t),r=[];for(const o of n){const m=T(o),s=m.split(/\s+/);if(s.length>=3&&v(s[0])&&v(s[1])&&v(s[2])){if(s.length>=4&&v(s[3]))continue;r.push(m)}}H(r)}const F=[],ie=[...a.faces||[],...a.facets||[]];function G(t,c){return`${t}->${c}`}for(const t of ie){const c=y(t);for(const n of c){const r=T(n);if(!r)continue;const o=r.split(/\s+/);if(o.length>=4&&v(o[0])&&U(o[1])&&U(o[2])&&U(o[3])){const m=parseInt(o[0],10),s=[];for(let e=1;e<o.length&&U(o[e]);e++)s.push(parseInt(o[e],10));if(s.length<3)continue;const h=[],I=[];let P=!0;for(const e of s){const i=Math.abs(e),g=W[i];if(!g){P=!1;break}I.push([g[0],g[1]]),h.push(e<0?[g[1],g[0]]:[g[0],g[1]])}if(!P||!h.length)continue;if(s.length===3){const e=[h[0][0],h[1][0],h[2][0]];if(new Set(e).size===3){F.push({faceId:m,edgeIds:s,tris:[e]});continue}}const j=new Set;for(const[e,i]of h)j.add(e),j.add(i);const z=[...j];if(z.length===3){const e=new Map;for(const[w,V]of I)e.has(w)||e.set(w,new Set),e.has(V)||e.set(V,new Set),e.get(w).add(V),e.get(V).add(w);const i=z[0],g=[...e.get(i)??[]];if(g.length!==2)continue;const[X,$]=g,D=new Set(h.map(([w,V])=>G(w,V))),J=[i,X,$],Q=[i,$,X],ee=w=>(D.has(G(w[0],w[1]))?1:0)+(D.has(G(w[1],w[2]))?1:0)+(D.has(G(w[2],w[0]))?1:0);F.push({faceId:m,edgeIds:s,tris:[ee(Q)>ee(J)?Q:J]});continue}const E=new Map,L=new Map,O=new Map;for(const[e,i]of h)E.has(e)||E.set(e,[]),E.get(e).push(i),O.set(e,(O.get(e)??0)+1),L.set(i,(L.get(i)??0)+1),L.has(e)||L.set(e,L.get(e)??0),O.has(i)||O.set(i,O.get(i)??0);let N=z[0];for(const e of z){const i=L.get(e)??0;if((O.get(e)??0)>i){N=e;break}}const b=[N];let R=N;const re=h.length;let le=0;for(;le++<re+5;){const e=E.get(R)??[];if(e.length){const i=e.shift();if(b.push(i),R=i,R===N)break}else{let i=!1;for(const[g,X]of E){const $=X.indexOf(R);if($>=0){X.splice($,1),E.has(R)||E.set(R,[]),E.get(R).push(g);const D=g;b.push(D),R=D,i=!0;break}}if(!i)break}}if(b.length>=2&&b[0]===b[b.length-1]&&b.pop(),new Set(b).size<3)continue;const _=[];for(let e=1;e<b.length-1;e++){const i=[b[0],b[e],b[e+1]];new Set(i).size===3&&_.push(i)}if(!_.length)continue;F.push({faceId:m,edgeIds:s,tris:_})}}}let Y=0;for(const t of F)Y+=t.tris.length;return console.group("%cFE-Parser","color:#06b; font-weight:bold;"),console.log("RMAX, ZMAX:",u,S),console.log("Vertices:",x.length),console.log("Edges:",Object.keys(W).length),console.log("Faces (Loops):",F.length,"→ Triangles:",Y),console.groupEnd(),{vertices:x,faces:F,vertexIdToIndex:p}}function Le(d){const f=new me,l=[];for(const k of d.faces)for(const W of k.tris)for(const H of W){const F=d.vertices[H];F&&l.push(F[0],F[1],F[2])}f.setAttribute("position",new we(l,3)),f.computeVertexNormals();const u=new te({color:4584770,side:Me,metalness:0,roughness:.35}),S=new te({color:16711680,side:be,metalness:0,roughness:.35}),a=new se(f,u),y=new se(f,S),x=new Fe(new ve(f),new Ie({color:0})),p=new Ee;return p.add(a,y,x),p}function Re(d){const f=new Se().setFromObject(d),l=f.getSize(new q),u=f.getCenter(new q),a=(Math.max(l.x,l.y,l.z)*.6+1e-6)/Math.tan(M.fov*Math.PI/360);M.position.copy(u.clone().add(new q(a,a,a))),M.near=Math.max(.01,a*.01),M.far=Math.max(1e3,a*10),M.updateProjectionMatrix(),Z.target.copy(u),Z.update()}async function Be(){const f=new URLSearchParams(location.search).get("fe"),l=f?"/Bachelorarbeit/"+f:ke,u=await fetch(l);if(!u.ok)throw new Error(`Konnte ${l} nicht laden (${u.status})`);const S=await u.text(),a=ye(S);let y=0;for(const p of a.faces)y+=p.tris.length;console.clear(),console.group("%cFE-Daten","color:#0a6; font-weight:bold;"),console.log("Vertices:",a.vertices.length),console.log("Faces (Loops):",a.faces.length,"→ Triangles:",y),console.table(a.faces.slice(0,50).map(p=>({faceId:p.faceId,edges:p.edgeIds.join(" "),tris:p.tris.map(k=>k.join(",")).join(" | ")}))),console.groupEnd();const x=Le({vertices:a.vertices,faces:a.faces});C.clear(),C.add(M),C.add(ce),C.add(new oe(16777215,.2)),C.add(x),Re(x)}Be().catch(d=>console.error(d));function ae(){requestAnimationFrame(ae),Z.update(),B.render(C,M)}ae();
