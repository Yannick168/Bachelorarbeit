import"./modulepreload-polyfill-B5Qt9EMX.js";import{A as y,c as m,l as G,p as q,f as W,m as T,a as K}from"./mat4-D_xUGRGy.js";function g(){var r=new y(3);return y!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function X(r){var t=r[0],e=r[1],o=r[2];return Math.hypot(t,e,o)}function $(r,t,e){var o=new y(3);return o[0]=r,o[1]=t,o[2]=e,o}function J(r,t){var e=t[0],o=t[1],a=t[2],c=e*e+o*o+a*a;return c>0&&(c=1/Math.sqrt(c)),r[0]=t[0]*c,r[1]=t[1]*c,r[2]=t[2]*c,r}function Q(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]}function Z(r,t,e){var o=t[0],a=t[1],c=t[2],s=e[0],i=e[1],l=e[2];return r[0]=a*l-c*i,r[1]=c*s-o*l,r[2]=o*i-a*s,r}(function(){var r=g();return function(t,e,o,a,c,s){var i,l;for(e||(e=3),o||(o=0),a?l=Math.min(a*e+o,t.length):l=t.length,i=o;i<l;i+=e)r[0]=t[i],r[1]=t[i+1],r[2]=t[i+2],c(r,r,s),t[i]=r[0],t[i+1]=r[1],t[i+2]=r[2];return t}})();function B(r,t,e){const o=r.createShader(t);if(r.shaderSource(o,e),r.compileShader(o),!r.getShaderParameter(o,r.COMPILE_STATUS)){const a=r.getShaderInfoLog(o);throw r.deleteShader(o),new Error("Shader compile error: "+a)}return o}function rr(r,t,e){const o=r.createProgram();if(r.attachShader(o,t),r.attachShader(o,e),r.linkProgram(o),!r.getProgramParameter(o,r.LINK_STATUS)){const a=r.getProgramInfoLog(o);throw r.deleteProgram(o),new Error("Program link error: "+a)}return o}const tr=`#version 300 es\r
layout(location=0) in vec3 aPosition;\r
layout(location=1) in vec4 aColor;\r
\r
uniform mat4 uMVP;\r
\r
out vec4 vColor;\r
\r
void main() {\r
  gl_Position = uMVP * vec4(aPosition, 1.0);\r
  vColor = aColor;\r
}\r
`,nr=`#version 300 es\r
precision mediump float;\r
\r
\r
in vec4 vColor;\r
out vec4 fColor;\r
\r
void main() {\r
  fColor = vColor; \r
}\r
`,h=document.getElementById("glCanvas"),n=h.getContext("webgl2");if(!n)throw new Error("WebGL2 not supported");n.enable(n.DEPTH_TEST);const or=B(n,n.VERTEX_SHADER,tr),er=B(n,n.FRAGMENT_SHADER,nr),M=rr(n,or,er);n.useProgram(M);function ar(r,t,e,o,a,c,s){const i=[],l=[];for(let u=0;u<=t;u++){const f=a+(c-a)*(u/t);for(let A=0;A<=r;A++){const E=e+(o-e)*(A/r),[p,P,S]=s(E,f),v=(f-a)/(c-a),Y=.2,j=1-v;i.push(p,P,S,v,Y,j,1)}}for(let u=0;u<t;u++)for(let f=0;f<r;f++){const A=u*(r+1),E=(u+1)*(r+1),p=A+f,P=A+f+1,S=E+f,v=E+f+1;l.push(p,P,v,p,v,S)}return{positions:new Float32Array(i),indices:new Uint16Array(l)}}function cr(r=1.5,t=24){const e=[],o=[];for(let a=0;a<=t;a++){const c=a*Math.PI/t;for(let s=0;s<=t;s++){const i=s*2*Math.PI/t,l=r*Math.sin(c)*Math.cos(i),u=r*Math.sin(c)*Math.sin(i),f=r*Math.cos(c);e.push(l,u,f,1,0,0,.3)}}for(let a=0;a<t;a++)for(let c=0;c<t;c++){const s=a*(t+1)+c,i=s+1,l=s+(t+1);o.push(s,i,s,l)}return{positions:new Float32Array(e),indices:new Uint16Array(o)}}const I=ar(100,100,0,2*Math.PI,-2,2,(r,t)=>[1*Math.cos(r)*Math.cosh(t),1*Math.sin(r)*Math.cosh(t),t]),ir=new Float32Array([0,0,0,1,0,0,1,2,0,0,1,0,0,1,0,0,0,0,1,0,1,0,2,0,0,1,0,1,0,0,0,0,0,1,1,0,0,2,0,0,1,1]),sr=new Uint16Array([0,1,2,3,4,5]);function x(r,t){const e=n.createVertexArray(),o=n.createBuffer(),a=n.createBuffer();return n.bindVertexArray(e),n.bindBuffer(n.ARRAY_BUFFER,o),n.bufferData(n.ARRAY_BUFFER,r,n.STATIC_DRAW),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,a),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t,n.STATIC_DRAW),n.enableVertexAttribArray(0),n.vertexAttribPointer(0,3,n.FLOAT,!1,7*4,0),n.enableVertexAttribArray(1),n.vertexAttribPointer(1,4,n.FLOAT,!1,7*4,3*4),n.bindVertexArray(null),{vao:e,count:t.length}}const V=x(I.positions,I.indices),F=x(ir,sr),L=cr(2.5),C=x(L.positions,L.indices),lr=n.getUniformLocation(M,"uMVP"),U=m(),D=m(),N=m(),R=m(),b=m();G(D,[8,2,8],[0,0,0],[0,1,0]);q(N,Math.PI/4,h.width/h.height,.1,100);const O=1;function z(r,t,e){const o=$(r,t,0),a=r*r+t*t;if(a<=e*e)o[2]=Math.sqrt(e*e-a);else{const c=Math.sqrt(a);o[0]*=e/c,o[1]*=e/c}return o}function k(r){const t=h.getBoundingClientRect(),e=(r.clientX-t.left)/t.width*2-1,o=(t.bottom-r.clientY)/t.height*2-1;return[e,o]}let w=!1,_=!1,d=null;h.addEventListener("mousedown",r=>{w=!0,_=!0;const[t,e]=k(r);d=z(t,e,O)});h.addEventListener("mouseup",()=>{w=!1,_=!1,d=null});h.addEventListener("mousemove",r=>{if(!w||!d)return;const[t,e]=k(r),o=z(t,e,O),a=g();if(Z(a,d,o),X(a)<1e-5)return;const c=Q(d,o),s=Math.min(1,Math.max(-1,c)),i=Math.acos(s),l=m();J(a,a),W(l,i,a),T(b,l,b),d=o});function H(){K(U,b),T(R,D,U),T(R,N,R),n.clearColor(1,1,1,1),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),n.useProgram(M),n.uniformMatrix4fv(lr,!1,R),_&&(n.bindVertexArray(C.vao),n.drawElements(n.LINES,C.count,n.UNSIGNED_SHORT,0)),n.bindVertexArray(F.vao),n.drawElements(n.LINES,F.count,n.UNSIGNED_SHORT,0),n.bindVertexArray(V.vao),n.drawElements(n==null?void 0:n.TRIANGLES,V.count,n.UNSIGNED_SHORT,0),requestAnimationFrame(H)}H();
